<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Latihan Soal IPAS Kelas 4 - Bimbel Musafir One</title>
    
    <!-- React & Tailwind Libraries -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f0fdf4; -webkit-tap-highlight-color: transparent; }
        h1, h2, h3 { font-family: 'Comic Neue', cursive; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 4px solid #bbf7d0; box-shadow: 8px 8px 0px #86efac; border-radius: 1.5rem; }
        .btn-fun { transition: transform 0.1s, border-bottom 0.1s; border-bottom: 4px solid; }
        .btn-fun:active { transform: translateY(4px); border-bottom: 0px; }
        
        /* Loading Animation */
        .loader { border: 6px solid #f3f3f3; border-top: 6px solid #22c55e; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* Safe Area */
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body>
    <div id="root">
        <div style="text-align: center; padding-top: 100px;">
            <div class="loader"></div>
            <h3 style="color: #166534; font-weight: bold;">Memuat Soal...</h3>
            <p style="color: #888; font-size: 12px;">Bimbel Musafir One</p>
        </div>
    </div>

    <script>
        window.onerror = function(message, source, lineno, colno, error) {
            const root = document.getElementById('root');
            root.innerHTML = '<div style="padding:20px; text-align:center; color:red;"><h3>Terjadi Kesalahan</h3><p>'+message+'</p><button onclick="window.location.reload()" style="padding:10px; margin-top:10px; border:1px solid #ccc; background:#eee;">Muat Ulang</button></div>';
        };
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- DATA SOAL PAKET A (45 SOAL - TEKS SAJA) ---
        const paketA = [
            { id: 1, text: "Pak Tani sedang menanam jagung di ladang. Jagung termasuk jenis Sumber Daya Alam (SDA)...", options: { A: "Hayati", B: "Non-hayati", C: "Mineral", D: "Buatan" }, answer: "A", discussion: "Jagung adalah tumbuhan (makhluk hidup), maka termasuk SDA Hayati." },
            { id: 2, text: "Kursi plastik terbuat dari bijih plastik yang berasal dari minyak bumi. Asal benda tersebut adalah...", options: { A: "Hutan", B: "Pertambangan", C: "Pertanian", D: "Laut" }, answer: "B", discussion: "Minyak bumi diambil dari perut bumi melalui pertambangan." },
            { id: 3, text: "SDA yang jumlahnya terbatas dan akan habis jika dipakai terus menerus disebut...", options: { A: "SDA Hayati", B: "SDA Dapat Diperbarui", C: "SDA Tidak Dapat Diperbarui", D: "SDA Kekal" }, answer: "C", discussion: "SDA tidak dapat diperbarui jumlahnya terbatas." },
            { id: 4, text: "Contoh sumber daya alam yang dapat diperbarui adalah...", options: { A: "Emas", B: "Air dan Tanah", C: "Batu Bara", D: "Besi" }, answer: "B", discussion: "Air dan tanah selalu mengalami siklus pembaruan alami." },
            { id: 5, text: "Wilayah dataran tinggi sangat cocok untuk kegiatan ekonomi...", options: { A: "Tambak udang", B: "Perkebunan teh", C: "Pabrik garam", D: "Pelabuhan" }, answer: "B", discussion: "Teh tumbuh subur di udara sejuk dataran tinggi." },
            { id: 6, text: "Aktivitas kendaraan bermotor yang mengeluarkan asap tebal dapat menyebabkan...", options: { A: "Udara semakin segar", B: "Polusi udara dan perubahan iklim", C: "Hemat energi", D: "Lingkungan asri" }, answer: "B", discussion: "Asap kendaraan mengandung gas karbon pemicu polusi." },
            { id: 7, text: "Tindakan yang tepat dalam mengelola sampah organik (sisa makanan) adalah...", options: { A: "Buang ke sungai", B: "Dibakar", C: "Dibuat kompos", D: "Ditimbun plastik" }, answer: "C", discussion: "Sampah organik bisa membusuk menjadi pupuk kompos." },
            { id: 8, text: "Upaya pelestarian hewan langka agar tidak punah adalah...", options: { A: "Suaka Margasatwa", B: "Berburu", C: "Menebang hutan", D: "Memelihara di rumah" }, answer: "A", discussion: "Suaka Margasatwa adalah tempat perlindungan khusus hewan." },
            { id: 9, text: "Kerusakan di darat dan laut disebabkan oleh...", options: { A: "Alam", B: "Perbuatan manusia", C: "Laut", D: "Hewan" }, answer: "B", discussion: "Sesuai QS Ar-Rum ayat 41." },
            { id: 10, text: "Dampak penebangan hutan secara liar (gundul) adalah...", options: { A: "Kayu mudah didapat", B: "Udara segar", C: "Banjir & Longsor", D: "Tanah subur" }, answer: "C", discussion: "Hutan gundul tidak bisa menyerap air hujan." },
            { id: 11, text: "Andi menutup hidung saat melewati tumpukan sampah yang bau. Indra yang terganggu adalah...", options: { A: "Mata", B: "Telinga", C: "Penciuman", D: "Kulit" }, answer: "C", discussion: "Hidung mendeteksi bau." },
            { id: 12, text: "Bagian mata yang berwarna putih dan keras disebut...", options: { A: "Kornea", B: "Sklera", C: "Pupil", D: "Retina" }, answer: "B", discussion: "Sklera adalah lapisan pelindung mata berwarna putih." },
            { id: 13, text: "Bayangan benda jatuh tepat di bagian mata yaitu...", options: { A: "Lensa", B: "Retina", C: "Pupil", D: "Kornea" }, answer: "B", discussion: "Retina menangkap bayangan." },
            { id: 14, text: "Rabun dekat disebut juga...", options: { A: "Miopi", B: "Hipermetropi", C: "Buta Warna", D: "Silindris" }, answer: "B", discussion: "Hipermetropi (Rabun Dekat)." },
            { id: 15, text: "Bagian telinga bagian dalam yang berbentuk seperti rumah siput adalah...", options: { A: "Koklea", B: "Gendang", C: "Saluran", D: "Daun Telinga" }, answer: "A", discussion: "Koklea sering disebut rumah siput." },
            { id: 16, text: "Selain mendengar, telinga berfungsi sebagai alat...", options: { A: "Penglihatan", B: "Penciuman", C: "Keseimbangan", D: "Peraba" }, answer: "C", discussion: "Telinga bagian dalam mengatur keseimbangan tubuh." },
            { id: 17, text: "Selaput lendir pada hidung berfungsi...", options: { A: "Menyaring debu", B: "Melembapkan udara", C: "Mengenali bau", D: "Menghangatkan" }, answer: "B", discussion: "Agar rongga hidung tidak kering." },
            { id: 18, text: "Manfaat bersiwak adalah menjaga kesehatan...", options: { A: "Mata", B: "Mulut & Gigi", C: "Telinga", D: "Kulit" }, answer: "B", discussion: "Kebersihan mulut." },
            { id: 19, text: "Bagian tepi lidah peka terhadap rasa...", options: { A: "Manis", B: "Asin/Asam", C: "Pahit", D: "Pedas" }, answer: "B", discussion: "Tepi lidah sensitif rasa asam dan asin." },
            { id: 20, text: "Ujung jari sangat peka karena...", options: { A: "Kulit tebal", B: "Banyak saraf peraba", C: "Ada kuku", D: "Sering dipakai" }, answer: "B", discussion: "Banyak saraf peraba berkumpul di ujung jari." },
            { id: 21, text: "Balon mengembang membuktikan bahwa gas bersifat...", options: { A: "Kaku", B: "Menekan ke segala arah", C: "Tetap", D: "Volume tetap" }, answer: "B", discussion: "Gas mengisi seluruh ruangan." },
            { id: 22, text: "Benda yang bentuk dan volumenya selalu berubah adalah...", options: { A: "Batu", B: "Air", C: "Asap", D: "Kayu" }, answer: "C", discussion: "Gas (asap) tidak punya bentuk & volume tetap." },
            { id: 23, text: "Zat yang partikelnya sangat rapat adalah...", options: { A: "Padat", B: "Cair", C: "Gas", D: "Campuran" }, answer: "A", discussion: "Ciri zat padat." },
            { id: 24, text: "Aroma masakan tercium sampai jauh karena sifat gas...", options: { A: "Bergerak bebas", B: "Diam", C: "Mengalir", D: "Berat" }, answer: "A", discussion: "Difusi gas menyebar ke segala arah." },
            { id: 25, text: "Sifat utama zat cair adalah...", options: { A: "Bentuk tetap", B: "Bentuk mengikuti wadah", C: "Volume berubah", D: "Keras" }, answer: "B", discussion: "Cair beradaptasi dengan tempatnya." },
            { id: 26, text: "Uap air yang menempel di tutup panci berubah menjadi titik-titik air disebut...", options: { A: "Mencair", B: "Mengembun", C: "Menyublim", D: "Mengkristal" }, answer: "B", discussion: "Gas ke Cair." },
            { id: 27, text: "Kapur barus di lemari lama-kelamaan habis karena peristiwa...", options: { A: "Mencair", B: "Menguap", C: "Menyublim", D: "Membeku" }, answer: "C", discussion: "Padat ke Gas." },
            { id: 28, text: "Es kering (Dry Ice) dibuat dengan prinsip...", options: { A: "Membeku", B: "Menguap", C: "Deposisi/Sublimasi", D: "Mencair" }, answer: "C", discussion: "Gas CO2 dipadatkan langsung." },
            { id: 29, text: "Bensin yang dibiarkan dalam wadah terbuka akan habis karena...", options: { A: "Membeku", B: "Mencair", C: "Menguap", D: "Menyublim" }, answer: "C", discussion: "Cair ke Gas." },
            { id: 30, text: "Agar air menjadi es, suhu harus...", options: { A: "Dipanaskan", B: "Didinginkan", C: "Diaduk", D: "Dijemur" }, answer: "B", discussion: "Pelepasan kalor." },
            { id: 31, text: "Setrika mengubah energi listrik menjadi...", options: { A: "Gerak", B: "Panas", C: "Bunyi", D: "Cahaya" }, answer: "B", discussion: "Menghasilkan panas." },
            { id: 32, text: "Alat yang sama perubahan energinya dengan Kipas Angin (Gerak) adalah...", options: { A: "Blender", B: "Kompor", C: "Lampu", D: "Radio" }, answer: "A", discussion: "Blender menggunakan motor listrik." },
            { id: 33, text: "Baterai mengubah energi kimia menjadi...", options: { A: "Gerak", B: "Listrik", C: "Panas", D: "Bunyi" }, answer: "B", discussion: "Sumber arus listrik DC." },
            { id: 34, text: "Bel rumah mengubah listrik menjadi...", options: { A: "Lampu", B: "Panas", C: "Bunyi", D: "Gerak" }, answer: "C", discussion: "Menghasilkan suara." },
            { id: 35, text: "Alat pengubah gerak air menjadi listrik di PLTA adalah...", options: { A: "Baterai", B: "Generator", C: "Panel Surya", D: "Lampu" }, answer: "B", discussion: "Generator." },
            { id: 36, text: "Televisi menghasilkan energi...", options: { A: "Cahaya & Bunyi", B: "Gerak", C: "Kimia", D: "Panas & Gerak" }, answer: "A", discussion: "Gambar (Cahaya) dan Suara (Bunyi)." },
            { id: 37, text: "Fotosintesis tumbuhan membutuhkan energi...", options: { A: "Angin", B: "Cahaya Matahari", C: "Listrik", D: "Gerak" }, answer: "B", discussion: "Cahaya matahari." },
            { id: 38, text: "Uap panas di PLTU digunakan untuk memutar...", options: { A: "Roda", B: "Turbin", C: "Baling", D: "Jam" }, answer: "B", discussion: "Turbin uap." },
            { id: 39, text: "Energi kimia dari makanan diubah tubuh untuk bergerak menjadi...", options: { A: "Panas", B: "Gerak", C: "Bunyi", D: "Cahaya" }, answer: "B", discussion: "Tenaga untuk bergerak." },
            { id: 40, text: "Matahari menghasilkan energi...", options: { A: "Gerak", B: "Cahaya & Panas", C: "Listrik", D: "Bunyi" }, answer: "B", discussion: "Sinar dan hangat." },
            { id: 41, text: "SDA Hayati berasal dari...", options: { A: "Makhluk hidup", B: "Benda mati", C: "Tambang", D: "Udara" }, answer: "A", discussion: "Hayati = Hidup." },
            { id: 42, text: "Menjaga kesehatan mata dengan cara...", options: { A: "Baca tiduran", B: "Baca gelap", C: "Jarak 30cm & makan Vit A", D: "Main HP lama" }, answer: "C", discussion: "Posisi dan nutrisi." },
            { id: 43, text: "Perbedaan zat cair dan padat adalah...", options: { A: "Volume", B: "Bentuk mengikuti wadah", C: "Bentuk tetap", D: "Partikel" }, answer: "B", discussion: "Cair berubah bentuk." },
            { id: 44, text: "Menjemur baju basah memanfaatkan peristiwa...", options: { A: "Mencair", B: "Menguap", C: "Menyublim", D: "Membeku" }, answer: "B", discussion: "Air menguap." },
            { id: 45, text: "Persamaan Kipas, Blender, dan Mixer adalah...", options: { A: "Hasilkan Panas", B: "Hasilkan Cahaya", C: "Hasilkan Gerak", D: "Hasilkan Bunyi" }, answer: "C", discussion: "Semuanya berputar." }
        ];

        // --- DATA SOAL PAKET B (45 SOAL - TEKS SAJA) ---
        const paketB = [
            { id: 1, text: "Susu, Telur, dan Daging adalah hasil SDA...", options: { A: "Nabati", B: "Hewani", C: "Tambang", D: "Energi" }, answer: "B", discussion: "Berasal dari hewan." },
            { id: 2, text: "Batu bata berasal dari...", options: { A: "Tanah Liat", B: "Pasir", C: "Kayu", D: "Besi" }, answer: "A", discussion: "Tanah liat dibakar." },
            { id: 3, text: "SDA yang dapat habis disebut...", options: { A: "Terbarukan", B: "Tidak Terbarukan", C: "Lestari", D: "Abadi" }, answer: "B", discussion: "Jumlah terbatas." },
            { id: 4, text: "Matahari dan Angin termasuk SDA...", options: { A: "Dapat diperbarui", B: "Langka", C: "Mahal", D: "Tambang" }, answer: "A", discussion: "Selalu ada." },
            { id: 5, text: "Penduduk dataran rendah banyak bekerja sebagai...", options: { A: "Petani Padi", B: "Nelayan", C: "Pemetik Teh", D: "Penambang" }, answer: "A", discussion: "Pertanian sawah." },
            { id: 6, text: "Membuang sampah plastik ke sungai dapat menyebabkan...", options: { A: "Air jernih", B: "Banjir & Polusi", C: "Ikan senang", D: "Tanah subur" }, answer: "B", discussion: "Sumbatan aliran air." },
            { id: 7, text: "Menghemat listrik siang hari dengan cara...", options: { A: "Nyalakan lampu", B: "Buka Jendela", C: "Nyalakan AC", D: "Tidur" }, answer: "B", discussion: "Cahaya matahari alami." },
            { id: 8, text: "Dilarang berburu hewan langka bertujuan...", options: { A: "Koleksi", B: "Menjaga Ekosistem", C: "Diambil kulitnya", D: "Hobi" }, answer: "B", discussion: "Agar tidak punah." },
            { id: 9, text: "Kerusakan alam terjadi akibat ulah...", options: { A: "Bencana", B: "Manusia", C: "Takdir", D: "Hewan" }, answer: "B", discussion: "Tanggung jawab manusia." },
            { id: 10, text: "Hutan bakau rusak menyebabkan...", options: { A: "Abrasi", B: "Meletus", C: "Gempa", D: "Hujan" }, answer: "A", discussion: "Pengikisan pantai." },
            { id: 11, text: "Rasa manis permen dirasakan oleh...", options: { A: "Hidung", B: "Lidah", C: "Kulit", D: "Mata" }, answer: "B", discussion: "Lidah pengecap." },
            { id: 12, text: "Bagian mata yang memberi warna adalah...", options: { A: "Iris", B: "Pupil", C: "Lensa", D: "Retina" }, answer: "A", discussion: "Iris." },
            { id: 13, text: "Lensa mata berfungsi untuk...", options: { A: "Menangkap cahaya", B: "Memfokuskan cahaya", C: "Melindungi mata", D: "Mengatur cahaya" }, answer: "B", discussion: "Fokus bayangan." },
            { id: 14, text: "Kacamata lensa cekung untuk penderita...", options: { A: "Rabun Dekat", B: "Rabun Jauh (Miopi)", C: "Silinder", D: "Katarak" }, answer: "B", discussion: "Rabun jauh." },
            { id: 15, text: "Daun telinga berfungsi...", options: { A: "Menangkap Bunyi", B: "Mengubah Saraf", C: "Keseimbangan", D: "Melindungi Gendang" }, answer: "A", discussion: "Corong suara." },
            { id: 16, text: "Indra peraba adalah...", options: { A: "Rambut", B: "Kulit", C: "Kuku", D: "Otot" }, answer: "B", discussion: "Kulit." },
            { id: 17, text: "Saraf pembau terletak di...", options: { A: "Langit mulut", B: "Rongga hidung atas", C: "Telinga", D: "Lidah" }, answer: "B", discussion: "Hidung bagian atas." },
            { id: 18, text: "Menjaga telinga dengan cara...", options: { A: "Mendengar musik keras", B: "Pakai benda tajam", C: "Hindari suara bising", D: "Masukan air" }, answer: "C", discussion: "Hindari bising." },
            { id: 19, text: "Pangkal lidah peka rasa...", options: { A: "Manis", B: "Asin", C: "Pahit", D: "Asam" }, answer: "C", discussion: "Bagian belakang lidah." },
            { id: 20, text: "Kulit mengeluarkan keringat, fungsi...", options: { A: "Gerak", B: "Ekskresi (Suhu)", C: "Cerna", D: "Napas" }, answer: "B", discussion: "Mengatur suhu." },
            { id: 21, text: "Zat cair dipindah, bentuknya...", options: { A: "Tetap", B: "Berubah ikut wadah", C: "Bulat", D: "Kotak" }, answer: "B", discussion: "Ikuti wadah." },
            { id: 22, text: "Benda padat yang lunak adalah...", options: { A: "Batu", B: "Plastisin", C: "Kayu", D: "Besi" }, answer: "B", discussion: "Bisa dibentuk." },
            { id: 23, text: "Ciri benda gas...", options: { A: "Rapat", B: "Partikel bebas & jauh", C: "Bisa digenggam", D: "Volume tetap" }, answer: "B", discussion: "Partikel bebas." },
            { id: 24, text: "Ban sepeda kempes karena...", options: { A: "Memuai", B: "Udara keluar pori", C: "Membeku", D: "Mencair" }, answer: "B", discussion: "Partikel kecil keluar." },
            { id: 25, text: "Minyak goreng termasuk zat...", options: { A: "Padat", B: "Cair", C: "Gas", D: "Beku" }, answer: "B", discussion: "Cair." },
            { id: 26, text: "Lilin meleleh adalah perubahan...", options: { A: "Padat ke Cair", B: "Cair ke Padat", C: "Padat ke Gas", D: "Cair ke Gas" }, answer: "A", discussion: "Mencair." },
            { id: 27, text: "Air mendidih habis menjadi...", options: { A: "Beku", B: "Uap (Gas)", C: "Sublim", D: "Kristal" }, answer: "B", discussion: "Menguap." },
            { id: 28, text: "Pembuatan garam memanfaatkan...", options: { A: "Penguapan", B: "Pembekuan", C: "Sublimasi", D: "Peleburan" }, answer: "A", discussion: "Penguapan air laut." },
            { id: 29, text: "Mengkristal adalah perubahan...", options: { A: "Cair ke Padat", B: "Gas ke Padat", C: "Padat ke Gas", D: "Cair ke Gas" }, answer: "B", discussion: "Gas jadi padat." },
            { id: 30, text: "Membeku membutuhkan...", options: { A: "Panas", B: "Suhu dingin", C: "Angin", D: "Cahaya" }, answer: "B", discussion: "Dingin." },
            { id: 31, text: "Rice Cooker mengubah listrik menjadi...", options: { A: "Gerak", B: "Panas", C: "Bunyi", D: "Cahaya" }, answer: "B", discussion: "Panas." },
            { id: 32, text: "Prinsip kerja Solder sama dengan...", options: { A: "Oven listrik", B: "Kipas", C: "Bor", D: "TV" }, answer: "A", discussion: "Panas." },
            { id: 33, text: "Mobil berjalan menggunakan energi...", options: { A: "Kimia", B: "Listrik", C: "Panas", D: "Bunyi" }, answer: "A", discussion: "Bensin (Kimia)." },
            { id: 34, text: "Matahari mengeringkan baju dengan...", options: { A: "Warna", B: "Panas", C: "Cahaya", D: "Gerak" }, answer: "B", discussion: "Panas." },
            { id: 35, text: "Biola dimainkan dengan cara...", options: { A: "Digesek", B: "Ditiup", C: "Dipukul", D: "Dipetik" }, answer: "A", discussion: "Gesek." },
            { id: 36, text: "Radio Baterai mengubah...", options: { A: "Kimia -> Listrik -> Bunyi", B: "Listrik -> Gerak", C: "Gerak -> Listrik", D: "Panas -> Bunyi" }, answer: "A", discussion: "Kimia ke Bunyi." },
            { id: 37, text: "Fotosintesis terjadi karena...", options: { A: "Matahari", B: "Bulan", C: "Lampu", D: "Api" }, answer: "A", discussion: "Cahaya matahari." },
            { id: 38, text: "PLTA memanfaatkan aliran...", options: { A: "Uap", B: "Air", C: "Angin", D: "Gas" }, answer: "B", discussion: "Air." },
            { id: 39, text: "Saat olahraga tubuh terasa panas karena...", options: { A: "Energi Gerak & Panas", B: "Listrik", C: "Bunyi", D: "Cahaya" }, answer: "A", discussion: "Energi gerak." },
            { id: 40, text: "Sumber energi terbesar bumi...", options: { A: "Batu bara", B: "Matahari", C: "Minyak", D: "Air" }, answer: "B", discussion: "Matahari." },
            { id: 41, text: "SDA Non-Hayati contohnya...", options: { A: "Ayam", B: "Padi", C: "Emas & Air", D: "Ikan" }, answer: "C", discussion: "Benda mati." },
            { id: 42, text: "Suara terlalu keras bisa merusak...", options: { A: "Mata", B: "Gendang Telinga", C: "Hidung", D: "Kulit" }, answer: "B", discussion: "Gendang telinga." },
            { id: 43, text: "Batu keras karena partikelnya...", options: { A: "Renggang", B: "Sangat Rapat", C: "Cair", D: "Gas" }, answer: "B", discussion: "Rapat." },
            { id: 44, text: "Garam terbentuk karena air laut...", options: { A: "Menguap", B: "Membeku", C: "Menyublim", D: "Mencair" }, answer: "A", discussion: "Menguap." },
            { id: 45, text: "Lampu, TV, Komputer butuh...", options: { A: "Baterai", B: "Listrik", C: "Bensin", D: "Matahari" }, answer: "B", discussion: "Listrik." }
        ];

        function App() {
            const [step, setStep] = useState('welcome');
            const [paket, setPaket] = useState('A');
            const [nama, setNama] = useState('');
            const [answers, setAnswers] = useState({});
            const [page, setPage] = useState(0);
            const [timeLeft, setTimeLeft] = useState(90 * 60);
            const [activeQuestions, setActiveQuestions] = useState([]);

            useEffect(() => {
                let timer;
                if (step === 'quiz' && timeLeft > 0) {
                    timer = setInterval(() => setTimeLeft(prev => prev - 1), 1000);
                } else if (timeLeft === 0 && step === 'quiz') {
                    setStep('result');
                }
                return () => clearInterval(timer);
            }, [step, timeLeft]);

            const startQuiz = () => {
                if (!nama.trim()) { alert("Isi nama dulu ya!"); return; }
                setActiveQuestions(paket === 'A' ? paketA : paketB);
                setAnswers({});
                setPage(0);
                setTimeLeft(90 * 60);
                setStep('quiz');
                window.scrollTo(0, 0);
            };

            const calculateScore = () => {
                let correct = 0;
                activeQuestions.forEach(q => { if (answers[q.id] === q.answer) correct++; });
                return (correct / activeQuestions.length) * 100;
            };

            const formatTime = (s) => {
                const m = Math.floor(s / 60);
                const sec = s % 60;
                return `${m}:${sec < 10 ? '0' : ''}${sec}`;
            };

            if (step === 'welcome') {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4 bg-green-50">
                        <div className="glass-panel p-8 max-w-md w-full text-center">
                            <h2 className="text-xl font-bold text-green-700">Selamat Datang</h2>
                            <h1 className="text-3xl font-black text-green-600 mb-2">Bimbel Musafir One</h1>
                            <p className="text-sm text-gray-500 mb-6 font-bold">Latihan Soal IPAS (45 Soal)</p>
                            <input type="text" value={nama} onChange={e => setNama(e.target.value)} placeholder="Tulis Nama Kamu..." className="w-full p-4 border-2 border-green-300 rounded-xl mb-4 text-center font-bold text-lg focus:outline-none focus:border-green-500" />
                            <div className="flex gap-2 mb-6">
                                <button onClick={() => setPaket('A')} className={`flex-1 p-3 rounded-xl border-2 font-bold transition-all ${paket === 'A' ? 'bg-green-500 text-white scale-105 shadow-md' : 'bg-white text-gray-500'}`}>Paket A</button>
                                <button onClick={() => setPaket('B')} className={`flex-1 p-3 rounded-xl border-2 font-bold transition-all ${paket === 'B' ? 'bg-blue-500 text-white scale-105 shadow-md' : 'bg-white text-gray-500'}`}>Paket B</button>
                            </div>
                            <button onClick={startQuiz} className="w-full bg-yellow-400 py-4 rounded-xl font-black text-xl border-b-4 border-yellow-600 btn-fun shadow-lg text-yellow-900">MULAI! üöÄ</button>
                        </div>
                    </div>
                );
            }

            if (step === 'quiz') {
                const limit = 10;
                const start = page * limit;
                const currentQ = activeQuestions.slice(start, start + limit);
                const totalPages = Math.ceil(activeQuestions.length / limit);
                const isLastPage = start + limit >= activeQuestions.length;

                return (
                    <div className="max-w-3xl mx-auto p-4 pb-48">
                        <div className="fixed top-0 left-0 right-0 bg-white shadow-md z-50 border-b-4 border-green-200 px-4 py-2 flex justify-between items-center h-16 safe-top">
                            <div><div className="text-[10px] font-bold text-green-800">SISWA</div><div className="font-bold text-green-700 truncate max-w-[150px]">{nama}</div></div>
                            <div className="font-mono font-bold bg-green-100 text-green-700 px-3 py-1 rounded-lg border border-green-300">{formatTime(timeLeft)}</div>
                        </div>

                        <div className="mt-20 space-y-6">
                            {currentQ.map((q, idx) => (
                                <div key={q.id} className="bg-white p-5 rounded-2xl shadow-sm border-2 border-green-100 relative overflow-hidden">
                                    <div className="absolute top-0 left-0 bg-green-500 text-white px-3 py-1 rounded-br-xl font-bold text-sm shadow">No. {start + idx + 1}</div>
                                    <div className="mt-8">
                                        <p className="font-bold text-gray-800 mb-6 text-lg leading-relaxed">{q.text}</p>
                                        <div className="grid grid-cols-1 gap-3">
                                            {Object.entries(q.options).map(([k, v]) => (
                                                <button key={k} onClick={() => setAnswers({...answers, [q.id]: k})} className={`text-left p-4 rounded-xl border-2 flex items-center gap-4 transition-all ${answers[q.id] === k ? 'bg-green-100 border-green-500 shadow-sm' : 'bg-white border-gray-200 hover:bg-gray-50 active:scale-[0.99]'}`}>
                                                    <span className={`w-8 h-8 flex items-center justify-center rounded-lg font-bold text-sm flex-shrink-0 transition-colors ${answers[q.id] === k ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-500'}`}>{k}</span>
                                                    <span className="text-base font-medium text-gray-700">{v}</span>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="mt-12 mb-10 p-6 bg-green-50 rounded-2xl border-2 border-green-100 text-center">
                            <h3 className="text-sm font-bold text-green-800 mb-4 uppercase tracking-widest">Navigasi Halaman</h3>
                            <div className="flex gap-4 justify-center">
                                <button disabled={page === 0} onClick={() => {setPage(p=>p-1);window.scrollTo(0,0)}} className="px-6 py-3 bg-white border-2 border-gray-300 rounded-xl font-bold text-gray-500 disabled:opacity-50">‚Üê Sebelumnya</button>
                                {isLastPage ? 
                                    <button onClick={() => setStep('result')} className="px-8 py-3 bg-green-600 text-white rounded-xl font-bold shadow-lg border-b-4 border-green-800 btn-fun">SELESAI ‚úÖ</button> :
                                    <button onClick={() => {setPage(p=>p+1);window.scrollTo(0,0)}} className="px-8 py-3 bg-blue-500 text-white rounded-xl font-bold shadow-lg border-b-4 border-blue-700 btn-fun">SELANJUTNYA ‚Üí</button>
                                }
                            </div>
                        </div>

                        <div className="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur border-t-2 border-gray-200 shadow-[0_-4px_15px_rgba(0,0,0,0.1)] p-3 z-50 flex items-center justify-between safe-bottom">
                            <button disabled={page === 0} onClick={() => {setPage(p=>p-1);window.scrollTo(0,0)}} className="px-5 py-3 bg-gray-100 rounded-xl font-bold text-gray-600 disabled:opacity-30 active:bg-gray-200">‚Üê</button>
                            <span className="text-sm font-bold text-gray-400 bg-gray-100 px-3 py-1 rounded-full">Hal {page+1} / {totalPages}</span>
                            {isLastPage ? 
                                <button onClick={() => setStep('result')} className="px-6 py-3 bg-green-600 text-white rounded-xl font-bold shadow btn-fun">Selesai</button> :
                                <button onClick={() => {setPage(p=>p+1);window.scrollTo(0,0)}} className="px-6 py-3 bg-blue-500 text-white rounded-xl font-bold shadow btn-fun">Lanjut</button>
                            }
                        </div>
                    </div>
                );
            }

            if (step === 'result') {
                const score = calculateScore();
                const wrongs = activeQuestions.filter(q => answers[q.id] !== q.answer);
                return (
                    <div className="min-h-screen bg-green-50 p-6 pb-24">
                        <div className="max-w-2xl mx-auto bg-white p-8 rounded-3xl shadow-xl border-4 border-green-200 text-center mb-8 relative overflow-hidden">
                            <div className="absolute top-0 left-0 w-full h-3 bg-gradient-to-r from-green-400 via-yellow-400 to-blue-400"></div>
                            <h2 className="text-gray-400 font-bold uppercase text-xs tracking-widest mt-2">Nilai Akhir</h2>
                            <h1 className="text-7xl font-black text-green-600 my-4 tracking-tighter">{score.toFixed(0)}</h1>
                            <div className="inline-block bg-green-100 text-green-800 px-4 py-1 rounded-full font-bold text-xl mb-4">{nama}</div>
                            <p className="text-gray-500 font-medium">{score >= 80 ? "Luar Biasa! Pertahankan! üåü" : score >= 60 ? "Bagus! Tingkatkan lagi! üëç" : "Jangan menyerah, ayo belajar lagi! üí™"}</p>
                            <button onClick={() => window.location.reload()} className="mt-8 bg-gray-800 text-white px-8 py-3 rounded-xl font-bold hover:bg-gray-700 transition shadow-lg w-full">Kerjakan Lagi ‚Ü∫</button>
                        </div>
                        
                        {wrongs.length > 0 && <h3 className="text-center font-bold text-red-500 mb-4 uppercase tracking-wider text-sm">Perbaikan Jawaban ({wrongs.length})</h3>}
                        
                        {wrongs.map((q, i) => (
                            <div key={i} className="bg-white p-5 rounded-2xl shadow-sm border border-red-100 mb-4">
                                <div className="flex gap-3 mb-3">
                                    <span className="bg-red-100 text-red-600 font-bold px-2 py-1 rounded text-xs h-fit">No. {activeQuestions.indexOf(q)+1}</span>
                                    <p className="font-bold text-gray-800 text-sm leading-snug">{q.text}</p>
                                </div>
                                <div className="text-sm space-y-2 ml-10">
                                    <div className="flex items-center gap-2 text-red-500 bg-red-50 p-2 rounded w-fit text-xs font-bold">‚ùå {q.options[answers[q.id]] || "Kosong"}</div>
                                    <div className="flex items-center gap-2 text-green-600 bg-green-50 p-2 rounded w-fit text-xs font-bold">‚úÖ {q.options[q.answer]}</div>
                                    <div className="bg-blue-50 p-3 rounded-lg text-blue-800 text-xs border border-blue-100 leading-relaxed">üí° {q.discussion}</div>
                                </div>
                            </div>
                        ))}
                        {wrongs.length === 0 && <div className="text-center p-8 bg-green-100 rounded-3xl font-bold text-green-700 border-2 border-green-200 text-xl">üéâ SEMPURNA! <br/>Semua jawabanmu BENAR!</div>}
                        
                        <div className="text-center mt-12 text-gray-400 font-bold text-xs font-mono">Bimbel Musafir One</div>
                    </div>
                );
            }
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

